<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Slides PHY 480 and PHY 905  Lectures: Ordinary differential equations">

<title>Slides PHY 480 and PHY 905  Lectures: Ordinary differential equations</title>

<!-- Bootstrap style: bootstrap -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
</style>


<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Differential equations program', 2, None, '___sec0'),
              ('Differential Equations, chapter 8', 2, None, '___sec1'),
              ('Differential Equations', 2, None, '___sec2'),
              ('Differential Equations', 2, None, '___sec3'),
              ('Differential Equations', 2, None, '___sec4'),
              ('Differential Equations', 2, None, '___sec5'),
              ('Differential Equations, Finite Difference',
               2,
               None,
               '___sec6'),
              ('Differential Equations', 2, None, '___sec7'),
              ('Differential Equations', 2, None, '___sec8'),
              ('Differential Equations', 2, None, '___sec9'),
              ('Differential Equations', 2, None, '___sec10'),
              ('Differential Equations', 2, None, '___sec11'),
              ('Differential Equations', 2, None, '___sec12'),
              ('Differential Equations', 2, None, '___sec13'),
              ('Differential Equations', 2, None, '___sec14'),
              ('Differential Equations', 2, None, '___sec15'),
              ('Differential Equations, Runge-Kutta methods',
               2,
               None,
               '___sec16'),
              ('Differential Equations, Runge-Kutta methods',
               2,
               None,
               '___sec17'),
              ('Differential Equations, Runge-Kutta methods',
               2,
               None,
               '___sec18'),
              ('Differential Equations, Runge-Kutta methods',
               2,
               None,
               '___sec19'),
              ('Building a code for the solar system, gravitational force and constants',
               2,
               None,
               '___sec20'),
              ('Building a code for the solar system, force equations',
               2,
               None,
               '___sec21'),
              ('Building a code for the solar system, coupled equations',
               2,
               None,
               '___sec22'),
              ('Building a code for the solar system, final coupled equations',
               2,
               None,
               '___sec23'),
              ('Building a code for the solar system, discretized equations',
               2,
               None,
               '___sec24'),
              ('Building a code for the solar system, adding Jupiter',
               2,
               None,
               '___sec25'),
              ('Building a code for the solar system, adding Jupiter',
               2,
               None,
               '___sec26'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec27'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec28'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec29'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec30'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec31'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec32'),
              ('Simple Example, Block tied to a Wall, python code',
               2,
               None,
               '___sec33'),
              ('The classical pendulum', 2, None, '___sec34'),
              ('More on the Pendulum', 2, None, '___sec35'),
              ('More on the Pendulum', 2, None, '___sec36'),
              ('More on the Pendulum', 2, None, '___sec37'),
              ('Adaptive methods', 2, None, '___sec38'),
              ('Adaptive methods', 2, None, '___sec39'),
              ('Adaptive methods', 2, None, '___sec40'),
              ('Adaptive methods', 2, None, '___sec41'),
              ('Adaptive methods, RKF45', 2, None, '___sec42'),
              ('Adaptive methods, RKF45', 2, None, '___sec43'),
              ('Solar system code, main program', 2, None, '___sec44'),
              ('Solar system code, planet class, header file',
               2,
               None,
               '___sec45'),
              ('Solar system code, planet class', 2, None, '___sec46'),
              ('Solar system code, solver class', 2, None, '___sec47'),
              ('Solar system code, solver code', 2, None, '___sec48')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="ode-bs.html">Slides PHY 480 and PHY 905  Lectures: Ordinary differential equations</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._ode-bs001.html#___sec0" style="font-size: 80%;">Differential equations program</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs002.html#___sec1" style="font-size: 80%;">Differential Equations, chapter 8</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs003.html#___sec2" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs004.html#___sec3" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs005.html#___sec4" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs006.html#___sec5" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs007.html#___sec6" style="font-size: 80%;">Differential Equations, Finite Difference</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs008.html#___sec7" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs009.html#___sec8" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs010.html#___sec9" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs011.html#___sec10" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs012.html#___sec11" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs013.html#___sec12" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs014.html#___sec13" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs015.html#___sec14" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs016.html#___sec15" style="font-size: 80%;">Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs017.html#___sec16" style="font-size: 80%;">Differential Equations, Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs018.html#___sec17" style="font-size: 80%;">Differential Equations, Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs019.html#___sec18" style="font-size: 80%;">Differential Equations, Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs020.html#___sec19" style="font-size: 80%;">Differential Equations, Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs021.html#___sec20" style="font-size: 80%;">Building a code for the solar system, gravitational force and constants</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs022.html#___sec21" style="font-size: 80%;">Building a code for the solar system, force equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs023.html#___sec22" style="font-size: 80%;">Building a code for the solar system, coupled equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs024.html#___sec23" style="font-size: 80%;">Building a code for the solar system, final coupled equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs025.html#___sec24" style="font-size: 80%;">Building a code for the solar system, discretized equations</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs026.html#___sec25" style="font-size: 80%;">Building a code for the solar system, adding Jupiter</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs027.html#___sec26" style="font-size: 80%;">Building a code for the solar system, adding Jupiter</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs028.html#___sec27" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs029.html#___sec28" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs030.html#___sec29" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs031.html#___sec30" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs032.html#___sec31" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs033.html#___sec32" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs034.html#___sec33" style="font-size: 80%;">Simple Example, Block tied to a Wall, python code</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs035.html#___sec34" style="font-size: 80%;">The classical pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs036.html#___sec35" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs037.html#___sec36" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs038.html#___sec37" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs039.html#___sec38" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs040.html#___sec39" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs041.html#___sec40" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs042.html#___sec41" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="#___sec42" style="font-size: 80%;">Adaptive methods, RKF45</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs044.html#___sec43" style="font-size: 80%;">Adaptive methods, RKF45</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs045.html#___sec44" style="font-size: 80%;">Solar system code, main program</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs046.html#___sec45" style="font-size: 80%;">Solar system code, planet class, header file</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs047.html#___sec46" style="font-size: 80%;">Solar system code, planet class</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs048.html#___sec47" style="font-size: 80%;">Solar system code, solver class</a></li>
     <!-- navigation toc: --> <li><a href="._ode-bs049.html#___sec48" style="font-size: 80%;">Solar system code, solver code</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0043"></a>
<!-- !split -->

<h2 id="___sec42">Adaptive methods, RKF45 </h2>
<div class="panel panel-default">
<div class="panel-body">
At each step, two different approximations for the solution are made and compared. If the
two answers are in close agreement, the approximation is accepted. If the two answers
do not agree to a specified accuracy, the step size is reduced. If the answers agree to
more significant digits than required, the step size is increased.
Each step requires the use of the following six values:
$$
k_1 = h f (t_k , y_k ),
$$

$$
k_2 = h f (t_k + \frac{1}{4}h, y_k + \frac{1}{4}k_1) ,
$$

$$
k_3 = h f (t_k + \frac{3}{8}h, y_k + \frac{3}{32}k_1 + \frac{9}{32}k_2) ,
$$

$$
k_4 = h f (t_k + \frac{12}{13}h, y_k + \frac{1932}{2197}k_1 + \frac{7200}{2197}k_2+\frac{7296}{2197}k_3),
$$

$$
k_5 = h f (t_k + h, y_k + \frac{439}{216}k_1 -8k_2+ \frac{3680}{513}k_3+\frac{845}{4104}k_4),
$$

$$
k_6 = h f (t_k + \frac{1}{2}h, y_k - \frac{8}{27}k_1 + 2k_2-\frac{3544}{2565}k_2+\frac{1859}{4104}k_4-+\frac{11}{40}k_5).
$$
</div>
</div>


<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._ode-bs042.html">&laquo;</a></li>
  <li><a href="._ode-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._ode-bs035.html">36</a></li>
  <li><a href="._ode-bs036.html">37</a></li>
  <li><a href="._ode-bs037.html">38</a></li>
  <li><a href="._ode-bs038.html">39</a></li>
  <li><a href="._ode-bs039.html">40</a></li>
  <li><a href="._ode-bs040.html">41</a></li>
  <li><a href="._ode-bs041.html">42</a></li>
  <li><a href="._ode-bs042.html">43</a></li>
  <li class="active"><a href="._ode-bs043.html">44</a></li>
  <li><a href="._ode-bs044.html">45</a></li>
  <li><a href="._ode-bs045.html">46</a></li>
  <li><a href="._ode-bs046.html">47</a></li>
  <li><a href="._ode-bs047.html">48</a></li>
  <li><a href="._ode-bs048.html">49</a></li>
  <li><a href="._ode-bs049.html">50</a></li>
  <li><a href="._ode-bs044.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

